#!/bin/bash
set -e
diff=`git log ..master`
changes=`git log master..`

if [ -z "$changes" ]; then
	echo No changes to merge
	exit 1
fi

branch=`git symbolic-ref --short -q HEAD`
git pull

if [ -n "$diff" ]; then
	git rebase master \
	&& git push --force
fi

git checkout master \
&& git pull \
&& git merge $branch \
&& git push \
