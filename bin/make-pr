#!/bin/bash

# Find base branch by -b flag
base=`echo $@ | sed -r 's/^.*-b ([^ ]+).*$/\1/'`

# Default base branch to master
if [[ $base == $@ ]]; then
	base=master
fi

nbrCommits=`git rev-list $base.. --count`

if [[ "$nbrCommits" == "0" ]]; then
	echo No commits since $base
	exit 1
fi

# Set no edit option if only one commit present
# Overridable with the --edit flag
if [[ "$nbrCommits" == "1" &&  $@ != *"--edit"* ]]; then
	opts=--no-edit
fi

hub pull-request $@ $opts
